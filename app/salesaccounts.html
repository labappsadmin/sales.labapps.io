<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accounts - Sales Module</title>
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="../assets/css/style.css">
    <link href="../lib/butterup-2.0.0/butterup.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@latest/pace-theme-default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        .action-icons { visibility: hidden; white-space: nowrap; }
        .action-icons a { margin: 0 3px; font-size: 14px; }
        .action-icons a.edit-icon { color: #0d6efd; }
        .action-icons a.delete-icon { color: #dc3545; }
        #accountsTableBody tr:hover .action-icons { visibility: visible; }
        #accountsTableBody tr:hover { background-color: #f8f9fa; }
        .table thead th { position: sticky; top: 0; background-color: #fff; z-index: 10; cursor: pointer; }
        .table thead th.sortable:hover { background-color: #f8f9fa; }
        .sort-indicator { margin-left: 5px; font-size: 10px; }
        .status-badge { padding: 2px 8px; border-radius: 12px; font-size: 10px; font-weight: 500; }
        .status-active { background-color: #d4edda; color: #155724; }
        .status-prospect { background-color: #e2e3e5; color: #383d41; }
        .status-onboarding { background-color: #cce5ff; color: #004085; }
        .status-atrisk { background-color: #f8d7da; color: #721c24; }
        .status-inactive { background-color: #fff3cd; color: #856404; }
        .filter-bar { background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin-bottom: 20px; }
        .filter-row { margin-bottom: 10px; }
        .filter-row:last-child { margin-bottom: 0; }
        .opportunity-link { color: #0d6efd; text-decoration: none; cursor: pointer; }
        .opportunity-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <a href="../" class="sidebar-logo">LabApps</a>
        </div>
        <div id="sidebarMenu" class="sidebar-body"></div>
    </div>
    <div class="header-main px-3 px-lg-4">
        <a id="menuSidebar" href="#" class="menu-link me-3 me-lg-4"><i class="ri-menu-2-fill"></i></a>
        <div class="form-search me-auto">
            <input type="text" class="form-control" id="tappsearch" placeholder="Search Accounts">
            <i class="ri-search-line"></i>
        </div>
        <div class="dropdown dropdown-profile ms-3 ms-xl-4">
            <a href="" class="dropdown-link" data-bs-toggle="dropdown" data-bs-auto-close="outside">
                <div class="avatar online"><img src="../assets/img/img1.jpg" alt="" class="spanuserimg"></div>
            </a>
            <div class="dropdown-menu dropdown-menu-end mt-10-f">
                <div class="dropdown-menu-body">
                    <div class="avatar avatar-xl online mb-3"><img src="../assets/img/img1.jpg" alt="" class="spanuserimg"></div>
                    <h5 class="mb-1 text-dark fw-semibold spanusername">User</h5>
                    <p class="fs-sm text-secondary spanuserrole mb-1">Sales User</p>
                    <nav class="nav">
                        <a target="_blank" href="https://labapps.gitbook.io"><i class="ri-question-line"></i> Help Center</a>
                        <a href="../app/userprofile.html"><i class="ri-user-settings-line"></i> Account Settings</a>
                        <a href="#!" onclick="logoutuser();"><i class="ri-logout-box-r-line"></i> Log Out</a>
                    </nav>
                </div>
            </div>
        </div>
    </div>
    <div class="main main-app p-3">
        <div class="content">
            <div class="container">
                <div class="d-flex align-items-center justify-content-between mb-3">
                    <div>
                        <ol class="breadcrumb fs-sm mb-1">
                            <li class="breadcrumb-item"><a href="saleshome.html">Dashboard</a></li>
                            <li class="breadcrumb-item active">Accounts</li>
                        </ol>
                        <h4 class="main-title mb-0">Sales Accounts</h4>
                        <p class="text-muted">Manage customer accounts</p>
                    </div>
                    <nav>
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-sm btn-outline-primary d-flex align-items-center gap-2" onclick="showAddAccountModal()">
                                <i class="ri-add-line"></i>&nbsp;New Account
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-primary d-flex align-items-center gap-2" onclick="toggleFilters()">
                                <i class="ri-filter-line"></i>&nbsp;Filters <span id="filterCount" class="badge bg-primary ms-1" style="display:none;">0</span>
                            </button>
                        </div>
                    </nav>
                </div>
                <hr style="margin-top:0px;" />
                <!-- Filters Section -->
                <div class="filter-bar" id="filtersSection" style="display:none;">
                    <div class="row filter-row">
                        <div class="col-md-2">
                            <label class="form-label" style="font-size:11px; font-weight:600;">Owner</label>
                            <select class="form-select form-select-sm" id="filterOwner" style="width:100%;">
                                <option value="">All Owners</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" style="font-size:11px; font-weight:600;">Account Type</label>
                            <select class="form-select form-select-sm" id="filterAccountType" style="width:100%;">
                                <option value="">All Types</option>
                                <option value="Prospect">Prospect</option>
                                <option value="Customer">Customer</option>
                                <option value="Partner">Partner</option>
                                <option value="Vendor">Vendor</option>
                                <option value="Competitor">Competitor</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" style="font-size:11px; font-weight:600;">Industry</label>
                            <select class="form-select form-select-sm" id="filterIndustry" style="width:100%;">
                                <option value="">All Industries</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" style="font-size:11px; font-weight:600;">Region</label>
                            <select class="form-select form-select-sm" id="filterRegion" style="width:100%;">
                                <option value="">All Regions</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label" style="font-size:11px; font-weight:600;">Status</label>
                            <select class="form-select form-select-sm" id="filterStatus" style="width:100%;">
                                <option value="">All Statuses</option>
                                <option value="Active">Active</option>
                                <option value="Prospect">Prospect</option>
                                <option value="Onboarding">Onboarding</option>
                                <option value="At-Risk">At-Risk</option>
                                <option value="Inactive">Inactive</option>
                            </select>
                        </div>
                        <div class="col-md-2 d-flex align-items-end">
                            <button type="button" class="btn btn-sm btn-outline-secondary w-100" onclick="resetFilters()">
                                <i class="ri-refresh-line"></i>&nbsp;Reset
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Pagination and Page Size -->
                <div class="row mb-2">
                    <div class="col-md-6 d-flex align-items-center">
                        <label class="form-label me-2 mb-0" style="font-size:11px;">Page Size:</label>
                        <select class="form-select form-select-sm" id="pageSizeSelect" style="width:auto;" onchange="changePageSize()">
                            <option value="10">10</option>
                            <option value="25" selected>25</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                        <span class="ms-3 text-muted" style="font-size:11px;" id="resultsCount"></span>
                    </div>
                    <div class="col-md-6">
                        <nav aria-label="Accounts pagination">
                            <ul class="pagination pagination-sm justify-content-end mb-0" id="paginationContainer">
                            </ul>
                        </nav>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="table-responsive" style="max-height:600px; overflow-y:auto;">
                            <table class="table table-bordered" style="font-size:10pt;">
                                <thead>
                                    <tr>
                                        <th class="sortable" data-sort="accountnumber" onclick="sortTable('accountnumber')">
                                            Account # <span class="sort-indicator" id="sort_accountnumber"></span>
                                        </th>
                                        <th class="sortable" data-sort="accountname" onclick="sortTable('accountname')">
                                            Account Name <span class="sort-indicator" id="sort_accountname"></span>
                                        </th>
                                        <th>Type</th>
                                        <th class="sortable" data-sort="industry" onclick="sortTable('industry')">
                                            Industry <span class="sort-indicator" id="sort_industry"></span>
                                        </th>
                                        <th class="sortable" data-sort="region" onclick="sortTable('region')">
                                            Region <span class="sort-indicator" id="sort_region"></span>
                                        </th>
                                        <th>Status</th>
                                        <th class="sortable" data-sort="ownername" onclick="sortTable('ownername')">
                                            Owner <span class="sort-indicator" id="sort_ownername"></span>
                                        </th>
                                        <th>Last Activity</th>
                                        <th>Open Opps</th>
                                        <th class="sortable" data-sort="annualrevenue" onclick="sortTable('annualrevenue')">
                                            Annual Revenue <span class="sort-indicator" id="sort_annualrevenue"></span>
                                        </th>
                                        <th class="sortable" data-sort="createddate" onclick="sortTable('createddate')">
                                            Created <span class="sort-indicator" id="sort_createddate"></span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="accountsTableBody">
                                    <tr><td colspan="11" class="text-center">Loading accounts...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Add Account Modal -->
    <div class="modal fade" id="modalAddAccount">
        <div class="modal-dialog modal-dialog-centered modal-dialog-slideout">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Account</h5>
                </div>
                <div class="modal-body">
                    <form id="formAddAccount">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Account Name *</label>
                                <input type="text" class="form-control form-control-sm" id="accountName" required />
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Account Type</label>
                                <select class="form-select form-select-sm" id="accountType" style="width:100%;">
                                    <option value="">Select Type</option>
                                    <option value="Prospect">Prospect</option>
                                    <option value="Customer">Customer</option>
                                    <option value="Partner">Partner</option>
                                    <option value="Vendor">Vendor</option>
                                    <option value="Competitor">Competitor</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Industry</label>
                                <input type="text" class="form-control form-control-sm" id="accountIndustry" />
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Region</label>
                                <input type="text" class="form-control form-control-sm" id="accountRegion" />
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Status</label>
                                <select class="form-select form-select-sm" id="accountStatus" style="width:100%;">
                                    <option value="">Select Status</option>
                                    <option value="Active">Active</option>
                                    <option value="Prospect">Prospect</option>
                                    <option value="Onboarding">Onboarding</option>
                                    <option value="At-Risk">At-Risk</option>
                                    <option value="Inactive">Inactive</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Annual Revenue</label>
                                <input type="number" class="form-control form-control-sm" id="accountRevenue" />
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label class="form-label">Owner</label>
                                <select class="form-select form-select-sm" id="accountOwner" style="width:100%;">
                                    <option value="">Select Owner</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-outline-primary" onclick="saveAccount()">Save Account</button>
                </div>
            </div>
        </div>
    </div>
    <script src="../lib/jquery/jquery.min.js?v=2.7.0"></script>
    <script src="../lib/bootstrap/js/bootstrap.bundle.min.js?v=2.7.0"></script>
    <script src="../lib/perfect-scrollbar/perfect-scrollbar.min.js?v=2.7.0"></script>
    <script src="../lib/jqueryui/jquery-ui.min.js?v=2.7.0"></script>
    <script src="../assets/js/script.js?v=2.7.0"></script>
    <script src="../assets/js/core.js?v=2.7.0"></script>
    <script src="../assets/js/auth.js?v=2.7.0"></script>
    <script src="../lib/butterup-2.0.0/butterup.js?v=2.7.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js?v=2.7.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="../assets/js/cross-domain-auth.js?v=2.7.0"></script>
    <script src="../assets/js/salescore.js?v=2.7.0"></script>
    <script src="../assets/js/salesaccounts.js?v=2.7.0"></script>
    <script type="text/javascript">
        $(document).ajaxStart(function () { Pace.restart(); });
        $(document).ready(function () {
            $('.spanusername').html(displayname);
            $('.spanuserimg').attr('src', userimage);
            initAuthErrorHandling();
            loadDynamicMenu();
            if (orgid) loadAccounts();
        });
    </script>
</body>
</html>

